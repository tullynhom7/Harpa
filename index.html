<!DOCTYPE html>
    <html lang="pt-BR">
    <head>

        <!-- PWA -->
        <link rel="manifest" href="manifest.json" />
		<meta name="description" content="Letras dos hinos da Harpa Cristã">
		<meta name="mobile-web-app-capable" content="yes" />
		<meta name="application-name" content="Harpa Cristã" />
		<meta name="msapplication-starturl" content="/harpa/index.html" />
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

        <!-- Primary Meta Tags -->
        <title>Harpa Cristã</title>
        <meta name="title" content="Harpa Cristã" />
        <meta name="description" content="Letras dos hinos da Harpa Cristã" />

        <!-- Open Graph / Facebook -->
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://tullynhom7.github.io/harpa/index.html" />
        <meta property="og:title" content="Harpa Cristã" />
        <meta property="og:description" content="Letras dos hinos da Harpa Cristã" />
        <meta property="og:image" content="https://tullynhom7.github.io/harpa/src/img/og.png" />

        <!-- Twitter -->
        <!-- <meta property="twitter:card" content="summary_large_image" /> -->
        <!-- <meta property="twitter:url" content="https://tullynhom7.github.io/harpa/index.html" /> -->
        <!-- <meta property="twitter:title" content="Harpa Cristã" /> -->
        <!-- <meta property="twitter:description" content="Letras dos hinos da Harpa Cristã" /> -->
        <!-- <meta property="twitter:image" content="https://tullynhom7.github.io/harpa/src/img/og.png" /> -->

        <!-- Meta Tags Generated with https://metatags.io -->

        <!-- PWA IOS -->
        <!-- Ícones iOS - Apple Touch Icons -->
        <link rel="apple-touch-icon" sizes="16x16" href="src/PWA/ios/16.png">
        <link rel="apple-touch-icon" sizes="20x20" href="src/PWA/ios/20.png">
        <link rel="apple-touch-icon" sizes="29x29" href="src/PWA/ios/29.png">
        <link rel="apple-touch-icon" sizes="32x32" href="src/PWA/ios/32.png">
        <link rel="apple-touch-icon" sizes="40x40" href="src/PWA/ios/40.png">
        <link rel="apple-touch-icon" sizes="50x50" href="src/PWA/ios/50.png">
        <link rel="apple-touch-icon" sizes="57x57" href="src/PWA/ios/57.png">
        <link rel="apple-touch-icon" sizes="58x58" href="src/PWA/ios/58.png">
        <link rel="apple-touch-icon" sizes="60x60" href="src/PWA/ios/60.png">
        <link rel="apple-touch-icon" sizes="64x64" href="src/PWA/ios/64.png">
        <link rel="apple-touch-icon" sizes="72x72" href="src/PWA/ios/72.png">
        <link rel="apple-touch-icon" sizes="76x76" href="src/PWA/ios/76.png">
        <link rel="apple-touch-icon" sizes="80x80" href="src/PWA/ios/80.png">
        <link rel="apple-touch-icon" sizes="87x87" href="src/PWA/ios/87.png">
        <link rel="apple-touch-icon" sizes="100x100" href="src/PWA/ios/100.png">
        <link rel="apple-touch-icon" sizes="114x114" href="src/PWA/ios/114.png">
        <link rel="apple-touch-icon" sizes="120x120" href="src/PWA/ios/120.png">
        <link rel="apple-touch-icon" sizes="128x128" href="src/PWA/ios/128.png">
        <link rel="apple-touch-icon" sizes="144x144" href="src/PWA/ios/144.png">
        <link rel="apple-touch-icon" sizes="152x152" href="src/PWA/ios/152.png">
        <link rel="apple-touch-icon" sizes="167x167" href="src/PWA/ios/167.png">
        <link rel="apple-touch-icon" sizes="180x180" href="src/PWA/ios/180.png">
        <link rel="apple-touch-icon" sizes="192x192" href="src/PWA/ios/192.png">
        <link rel="apple-touch-icon" sizes="256x256" href="src/PWA/ios/256.png">
        <link rel="apple-touch-icon" sizes="512x512" href="src/PWA/ios/512.png">
        <link rel="apple-touch-icon" sizes="1024x1024" href="src/PWA/ios/1024.png">

        <!-- Configurações adicionais para iOS -->
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="default">
        <meta name="apple-mobile-web-app-title" content="Harpa Cristã" />

        <meta charset="UTF-8">
        <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">

        <title>Harpa Cristã</title>
        <!-- Material Pieces -->
        <link rel="stylesheet" href="src/css/pieces/pieces.css">
        <script src="src/js/pieces/pieces.js"></script>
        <!-- m css -->
        <link rel="stylesheet" href="src/css/style.css">
        <link rel="stylesheet" href="src/css/pages/home.css">
        <link rel="stylesheet" href="src/css/pages/favorite.css">
        <link rel="stylesheet" href="src/css/pages/config.css">
        <!-- m js -->
        <script src="src/js/tools.js"></script>
        <script src="src/js/harpa.js"></script>
        <script src="src/js/db.js"></script>
        <!-- m pages -->
        <script src="src/js/pages/home.js" defer></script>
        <script src="src/js/pages/favorite.js" defer></script>
        <script src="src/js/pages/config.js" defer></script>

        <!-- last m js -->
        <script src="src/js/index.js" defer></script>
        <!-- Libs js CDN -->
        <!-- <style>* {box-shadow: 0 0 0 1px rgba(255,0,0,0.2);}</style> -->
    </head>
    <body class="light triade piece-surface background-color-096 text-color-004">
        <header id="m-header" class="piece-surface">
            <div id="titulo">
                <img src="src/android/play_store_512.png" width="48px" height="48px" style="border-radius:12px;">
                <h1>Harpa Cristã</h1>
                <h2>Início</h2>
            </div>
            <div class="
                piece-search
                piece-surface
            ">
                <label class="
                    bar
                    piece-surface
                    piece-parent
                    border-color-048
                    piece-box-shadow
                    box-shadow-color-044-active
                    border-color-048-active
                ">
                    <input id="m-search" type="text" placeholder="buscar">
                    <button class="
                        search
                        piece-button
                        piece-surface
                        background-color-080
                        text-color-to-0820
                        background-color-hover-to-076
                    ">
                        <span class="piece-ripple"></span>
                        <span class="material-symbols-rounded piece-icon no-fill" translate="no">search</span>
                    </button>
                    <button class="
                        close
                        piece-button
                        piece-surface
                        background-color-080
                        text-color-to-0820
                        background-color-hover-to-076
                    ">
                        <span class="piece-ripple"></span>
                        <span class="material-symbols-rounded piece-icon no-fill" translate="no">arrow_back</span>
                    </button>
                    <button class="
                        clear
                        piece-button
                        piece-surface
                        background-color-080
                        text-color-to-0820
                        background-color-hover-to-076
                    ">
                        <span class="piece-ripple"></span>
                        <span class="material-symbols-rounded piece-icon no-fill" translate="no">cancel</span>
                    </button>
                </label>
                <div class="
                    menu
                    piece-surface
                    piece-parent
                    background-color-096
                    piece-box-shadow
                    box-shadow-color-044
                ">
                    <section id="numero" class="piece-surface border-color-080">
                        <header>Resultados por número</header>
                        <ul></ul>
                    </section>
                    <section id="letra" class="piece-surface border-color-080">
                        <header>Resultados por Letra</header>
                        <ul></ul>
                    </section>
                </div>
            </div>
        </header>
        <span id="m-divider-h" class="piece-divider piece-surface background-color-080"></span>
        <main id="m-main"></main>
        <span id="m-divider-v-1" class="piece-divider piece-surface background-color-080"></span>
        <nav id="m-nav"></nav>
        <span id="m-divider-v-2" class="piece-divider piece-surface background-color-080"></span>
        <aside id="m-aside"></aside>
        <style>
            #install_button {
                position: absolute;
                bottom: 16px;
                right: 16px;
                .install_mobile {display: none;}
            }
            @media screen and (max-width: 768px){
                #install_button {
                    bottom: 96px;
                    .install_mobile {display: grid;}
                    .install_desktop {display: none;}
                }
            }
        </style>
        <button
        style="display:none;"
        id="install_button" class="
            piece-FAB small
            piece-surface
            background-color-048
            background-color-044-hover
            text-color-100
            ripple-color-100
        ">
            <span class="material-symbols-rounded icon install_mobile" translate="no">install_mobile</span>
            <span class="material-symbols-rounded icon install_desktop" translate="no">install_desktop</span>
            <span class="piece-ripple"></span>
        </button>
        <!-- PWA | scripts -->
		<script src="scripts.js"></script>
        <script>

            let fragment = document.createDocumentFragment()

            document.querySelector("#m-header #m-search").addEventListener('input', (event)=>{
                let input = event.target.value

                document.querySelector("#numero ul").innerHTML = ""
                if(+input) {
                    db.filter(({numero})=>+numero.includes(+input))
                    .forEach(resultado=> {

                        const template = `
                            <label class="piece-surface background-color-088 text-color-012 tertiary ripple-color-048">
                                ${resultado.numero}
                                <span class="piece-ripple"></span>
                            </label>
                        `
                        fragment.appendChild(tools.create(template))

                    })
                    document.querySelector("#numero ul").appendChild(fragment)
                    document.querySelectorAll("#numero ul label").forEach(result=>{
                        result.addEventListener("click", (event)=>{
                            document.querySelectorAll(`#page-home button`)[result.innerText-1].click()
                            setTimeout(()=>document.querySelector('.close').click(),1)
                        })
                    })
                }

                fragment = document.createDocumentFragment()
                
                if(input.replace(/[0-9]/g, '') != "") {
                    
                    db.filter(({letra})=>letra
                        .split("#")
                        .filter((verso) => !verso.includes("Autor ou Tradutor:"))
                        .join("")
                        .normalize("NFD")
                        .replace(/[\u0300-\u036f]/g, "")
                        .replace(/[^a-zA-Z]/g, ' ')
                        .replace(/\s+/g, ' ').trim()
                        .toLowerCase()
                        .includes(
                            input
                            .normalize("NFD")
                            .replace(/[\u0300-\u036f]/g, "")
                            .replace(/[^a-zA-Z]/g, ' ')
                            .replace(/\s+/g, ' ').trim()
                            .toLowerCase()
                        )
                    )
                    .forEach(({nome, numero, letra}, i) => {
                        if(i<51) {
                            let card = `
                                <button 
                                    popovertarget="popover-modal"
                                    name="hino"
                                    value="${numero}"
                                    class="
                                        card-list
                                        piece-surface
                                        background-color-096
                                        background-color-092-hover
                                        ripple-color-048
                                        piece-ripple-to-096
                                    "
                                >
                                    <span class="numero piece-surface background-color-088 text-color-012 tertiary">${numero}</span>
                                    <span class="nome">${nome}</span>
                                    <span class="letra piece-surface background-color-088 text-color-012 secondary">
                                        <p>${letra.split("#")[0].replace(/^\d+/,"").split("@").join("</p><p>")}</p>
                                    </span>
                                    <span class="piece-piece-ripple"></span>
                                </label>
                            `
                            fragment.appendChild(tools.create(card))
                        }
                    })
                    document.querySelector("#letra ul").innerHTML = ""
                    document.querySelector("#letra ul").appendChild(fragment)
                    document.querySelectorAll("#letra ul button").forEach(result=>{
                        result.addEventListener("click", (event)=>{
                            document.querySelectorAll(`#page-home button`)[result.value-1].click()
                            setTimeout(()=>document.querySelector('.close').click(),1)
                        })
                    })
                }
            })
        </script>
    </body>
</html>